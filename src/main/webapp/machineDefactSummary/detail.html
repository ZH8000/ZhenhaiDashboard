<div data-lift="Surround?with=default;at=content">
  <div class="ui one column grid">
    <div class="ui fixedColumn center aligned column">
      <div class="ui four steps" data-lift="MachineDefactSummary.showStepsSelector">
        <a href="#" class="ui step active">2015-06</a>
      </div>
    </div>
    <div class="ui below center aligned column">
    </div>
  </div>
  <div class="ui one column grid">
    <div class="column" data-lift="MachineDefactSummary">
      <div>
        <a href="#" class="ui right floated primary button" id="excel">開啟 Excel</a>
      </div>
      <div style="clear: both; margin-bottom: 1em;" />

      <div class="ui top attached tabular menu">
        <a onClick="selectTab(1)" class="item active" data-tab="step1">卷取生產狀況表</a>
        <a onClick="selectTab(2)" class="item" data-tab="step2">組立機生產狀況表</a>
        <a onClick="selectTab(3)" class="item" data-tab="step3">老化機生產狀況表</a>
        <a onClick="selectTab(4)" class="item" data-tab="step51">TP 機生產狀況表</a>
        <a onClick="selectTab(5)" class="item" data-tab="step52">CUT 機生產狀況表</a>
      </div>
      <div class="ui bottom attached tab segment active" data-tab="step1">
        <table class="ui celled table" id="table1">
          <thead>
            <tr>
              <th>機台號</th>
              <th>機種</th>
              <th>尺寸</th>
              <th>區域</th>
              <th>標準量</th>
              <th>良品數</th>
              <th>稼動率</th>
              <th>良品率</th>
              <th>短路不良率</th>
              <th>素子導線棒不良率</th>
              <th>膠帶貼付不良率</th>
              <th>素子卷取不良率</th>
              <th>正導針損耗率</th>
              <th>負導針損耗率</th>
              <th>改善對策</th>
              <th>負責人</th>
            </tr>
          </thead>
          <tbody>
            <tr class="step1Rows">
              <td><span class="machineID">Cell</span></td>
              <td><span class="machineModel">Cell<span></td>
              <td><span class="product">Cell</span></td>
              <td><span class="area">Cell</span></td>
              <td><span class="standard">Cell</span></td>
              <td><span class="countQty">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="kadou">Cell</span>
                  </div>
                  <div class="content">
                    良品數：<span class="countQty">123</span><br/>
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="okRate">Cell</span>
                  </div>
                  <div class="content">
                    總數：<br/>
                    良品數 (<span class="countQty"></span>) +  <br/>
                    短路不良數 (<span class="short"></span>) + <br/>
                    素子导线棒不良数 (<span class="stick"></span>) + <br/>
                    胶带贴附不良数 (<span class="tape"></span>) + <br/>
                    素子卷取不良数 (<span class="roll"></span>)<br/>
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="shortRate">Cell</span><br/>
                  </div>
                  <div class="content">
                    短路不良數 (<span class="short"></span>) / 良品數 (<span class="countQty"></span>) <br/>
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="stickRate">Cell</span><br/>
                  </div>
                  <div class="content">
                    素子导线棒不良数 (<span class="stick"></span>) / 良品數 (<span class="countQty"></span>)<br/>
                  </div>
                </div>

              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="tapeRate">Cell</span> <br/>
                  </div>
                  <div class="content">
                    胶带贴附不良数 (<span class="tape"></span>)  / 良品數 (<span class="countQty"></span>)<br/>
                  </div>
                </div>

              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="rollRate">Cell</span> <br/>
                  </div>
                  <div class="content">
                    素子卷取不良数 (<span class="roll"></span>)  / 良品數 (<span class="countQty"></span>)<br/>
                  </div>
                </div>

              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="plusRate">Cell</span><br/>
                  </div>
                  <div class="content">
                    正導針投入數 (<span class="plus"></span>) / 良品數 (<span class="countQty"></span>) - 1
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="minusRate">Cell</span><br/>
                  </div>
                  <div class="content">
                    負導針投入數 (<span class="minus"></span>) / 良品數 (<span class="countQty"></span>) - 1
                  </div>
                </div>
              </td>
              <td><span class="policy">Cell</span></td>
              <td><span class="fixer">Cell</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="ui bottom attached tab segment" data-tab="step2">
        <table class="ui celled table" id="table2">
          <thead>
            <tr>
              <th>機台號</th>
              <th>機種</th>
              <th>尺寸</th>
              <th>區域</th>
              <th>標準量</th>
              <th>良品數</th>
              <th>總數</th>
              <th>稼動率</th>
              <th>良品率</th>
              <th>素子插入不良率</th>
              <th>不良品 D 不良率</th>
              <th>露白不良不良率</th>
              <th>柏梗損耗率</th>
              <th>外殼損耗率</th>
              <th>改善對策</th>
              <th>負責人</th>
            </tr>
          </thead>
          <tbody>
            <tr class="step2Rows">
              <td><span class="machineID">Cell</span></td>
              <td><span class="machineModel">Cell</span></td>
              <td><span class="product">Cell</span></td>
              <td><span class="area">Cell</span></td>
              <td><span class="standard">Cell</span></td>
              <td><span class="countQty">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="total">Cell</span>
                  </div>
                  <div class="content">
                    素子投入數(<span class="originalTotal"></span>)
                    <hr/>
                    良品數(<span class="countQty"></span>) + 不良品 D 數(<span class="defactD"></span>) + 
                    露白不良數(<span class="white"></span>)
                  </div>
                </div>
              </td>

              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="kadou">Cell</span>
                  </div>
                  <div class="content">
                    良品數 (<span class="countQty"></span>) / 標準量(<span class="standard"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="okRate">Cell</span>
                  </div>
                  <div class="content">
                    良品數 (<span class="countQty"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="insertRate">Cell</span>
                  </div>
                  <div class="content">
                    [素子投入數(<span class="total"></span>) - 不良品 D 數(<span class="defactD"></span>) - 露白不良數(<span class="white"></span> - 良品數(<span class="countQty"></span>) ] / 總數(<span class="total"></span>) - 1
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="defactDRate">Cell</span>
                  </div>
                  <div class="content">
                    不良品 D 數(<span class="defactD"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="whiteRate">Cell</span>
                  </div>
                  <div class="content">
                    露白不良數 (<span class="white"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="rubberRate">Cell</span>
                  </div>
                  <div class="content">
                    柏梗投入数 (<span class="rubber"></span>) / 良品數(<span class="countQty"></span>) - 1
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="shellRate">Cell</span>
                  </div>
                  <div class="content">
                    外殼投入数 (<span class="shell"></span>) / 良品數(<span class="countQty"></span>) - 1
                  </div>
                </div>
              </td>
              <td><span class="policy">Cell</span></td>
              <td><span class="fixer">Cell</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="ui bottom attached tab segment" data-tab="step3">
        <table class="ui celled table" id="table3">
          <thead>
            <tr>
              <th>機台號</th>
              <th>機種</th>
              <th>尺寸</th>
              <th>區域</th>
              <th>標準量</th>
              <th>總數</th>
              <th>良品數</th>
              <th>稼動率</th>
              <th>良品率</th>
              <th>短路不良率</th>
              <th>開路不良率</th>
              <th>容量不良率</th>
              <th>損失不良率</th>
              <th>LC 不良率</th>
              <th>重測不良率</th>
              <th>改善對策</th>
              <th>負責人</th>
            </tr>
          </thead>
          <tbody>
            <tr class="step3Rows">
              <td><span class="machineID">Cell</span></td>
              <td><span class="machineModel">Cell</span></td>
              <td><span class="product">Cell</span></td>
              <td><span class="area">Cell</span></td>
              <td><span class="standard">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="total">Cell</span>
                  </div>
                  <div class="content">
                    素子投入數(<span class="originalTotal"></span>)
                    <hr/>
                    良品數(<span class="countQty"></span>) + 容量不良數(<span class="capacity"></span>) + 
                    損失不良數(<span class="lose"></span>) + LC 不良數(<span class="lc"></span>) + 
                    重測不良數(<span class="retest"></span>)
                  </div>
                </div>
              </td>
              <td><span class="countQty">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="kadou">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 標準量(<span class="standard"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="okRate">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="shortRate">Cell</span>
                  </div>
                  <div class="content">
                    短路不良數(<span class="short"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="openRate">Cell</span>
                  </div>
                  <div class="content">
                    開路不良數(<span class="open"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="capacityRate">Cell</span>
                  </div>
                  <div class="content">
                    容量不良數(<span class="capacity"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="loseRate">Cell</span>
                  </div>
                  <div class="content">
                    損失不良數(<span class="lose"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="lcRate">Cell</span>
                  </div>
                  <div class="content">
                    LC 不良數(<span class="lc"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="retestRate">Cell</span>
                  </div>
                  <div class="content">
                    重測良數(<span class="retest"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>

              </td>
              <td><span class="policy">Cell</span></td>
              <td><span class="fixer">Cell</span></td>
            </tr>
          </tbody>
        </table>

      </div>
      <div class="ui bottom attached tab segment" data-tab="step51">
        <table class="ui celled table" id="table4">
          <thead>
            <tr>
              <th>機台號</th>
              <th>機種</th>
              <th>尺寸</th>
              <th>區域</th>
              <th>標準量</th>
              <th>良品數</th>
              <th>稼動率</th>
              <th>良品率</th>
              <th>改善對策</th>
              <th>負責人</th>
            </tr>
          </thead>
          <tbody>
            <tr class="step5Rows-1">
              <td><span class="machineID">Cell</span></td>
              <td><span class="machineModel">Cell</span></td>
              <td><span class="product">Cell</span></td>
              <td><span class="area">Cell</span></td>
              <td><span class="standard">Cell</span></td>
              <td><span class="countQty">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="kadou">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 標準量(<span class="standard"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="okRate">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>
              <td><span class="policy">Cell</span></td>
              <td><span class="fixer">Cell</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="ui bottom attached tab segment" data-tab="step52">
        <table class="ui celled table" id="table5">
          <thead>
            <tr>
              <th>機台號</th>
              <th>機種</th>
              <th>尺寸</th>
              <th>區域</th>
              <th>標準量</th>
              <th>良品數</th>
              <th>稼動率</th>
              <th>良品率</th>
              <th>改善對策</th>
              <th>負責人</th>
            </tr>
          </thead>
          <tbody>
            <tr class="step5Rows-2">
              <td><span class="machineID">Cell</span></td>
              <td><span class="machineModel">Cell</span></td>
              <td><span class="product">Cell</span></td>
              <td><span class="area">Cell</span></td>
              <td><span class="standard">Cell</span></td>
              <td><span class="countQty">Cell</span></td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="kadou">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 標準量(<span class="standard"></span>)
                  </div>
                </div>
              </td>
              <td>
                <div class="ui accordion">
                  <div class="title">
                    <i class="dropdown icon"></i>
                    <span class="okRate">Cell</span>
                  </div>
                  <div class="content">
                    良品數(<span class="countQty"></span>) / 總數(<span class="total"></span>)
                  </div>
                </div>
              </td>

              <td><span class="policy">Cell</span></td>
              <td><span class="fixer">Cell</span></td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>
  </div>
  <script>
   $('.menu .item').tab();
   $('.ui.accordion').accordion();
   $('#table1').floatThead({scrollingTop: 105});

   function selectTab(tab) {
     console.log('tab:' + tab);
     $('#table1').floatThead('destroy');
     $('#table2').floatThead('destroy');
     $('#table3').floatThead('destroy');
     $('#table4').floatThead('destroy');
     $('#table5').floatThead('destroy');
     $('#table' + tab).floatThead({scrollingTop: 105});
     $('#table' + tab).floatThead('reflow');
   }


  </script>
</div>
